
using Newtonsoft.Json;
using System.IO;
using System.Windows.Controls;
using System.Windows.Media.Imaging;

namespace MalwareDetection
{
    public partial class Dashboard : UserControl
    {
              
        private MalwareLibrary malwarelibrary;
        public Dashboard()
        {
            InitializeComponent();

            //Crate the Malware library file & Check it is malware or not
            malwarelibrary = new MalwareLibrary();

            checkforProtection();

            //listenTheStateOfSetting();
        }
        private void checkforProtection()
        {
            try
            {
                if (File.Exists("setting.json"))
                {
                    if (File.ReadAllText("setting.json").ToString()=="ON")
                    {
                        textForProtection.Text = "You Are Protected";

                        // Create a new BitmapImage with the image source
                        Uri resourceUri = new Uri(@"/mark.png", UriKind.Relative);

                        // Set the Source property of the Image control to the BitmapImage
                        imageForProtection.Source = new BitmapImage(resourceUri);

                    }
                    else
                    {
                        textForProtection.Text = "You Are Not Protected";

                        // Create a new BitmapImage with the image source
                        Uri resourceUri = new Uri(@"/cross.png", UriKind.Relative);

                        // Set the Source property of the Image control to the BitmapImage
                        imageForProtection.Source = new BitmapImage(resourceUri);
                        

                    }
                }
                else
                {
                    SystemInformation.createFileWithOverride("setting.json", "ON");

                    textForProtection.Text = "You Are Protected";

                    // Create a new BitmapImage with the image source
                    Uri resourceUri = new Uri(@"mark.png", UriKind.Relative);

                    // Set the Source property of the Image control to the BitmapImage
                    imageForProtection.Source = new BitmapImage(resourceUri);
                }
            }
            catch (Exception) { }
        } 

    }

}
